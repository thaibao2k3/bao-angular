<div class="container">
  <div class="header">
    <h2>Thêm sản phẩm</h2>
    <div class="header-buttons">
      <button class="btn btn-success" type="button" (click)="addProduct()">
        <svg class="icon-save" viewBox="0 0 24 24">
          <path
            fill="currentColor"
            d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"
          />
        </svg>
        Lưu
      </button>
    </div>
  </div>

  <div class="content">
    <!-- Ảnh -->
    <div class="product-section">
      <div class="image-upload" (click)="fileInput.click()">
        <ng-container *ngIf="product.imageUrl; else uploadIcon">
          <img
            [src]="product.imageUrl"
            style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;"
          />
        </ng-container>
        <ng-template #uploadIcon>
          <svg viewBox="0 0 24 24">
            <path d="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z" />
          </svg>
        </ng-template>
      </div>
      <input
        #fileInput
        type="file"
        hidden
        accept="image/*"
        (change)="onImageSelected($event)"
      />

      <div class="product-name-section">
        <div class="form-group">
          <label class="required">Tên sản phẩm</label>
          <input
            type="text"
            class="form-control"
            placeholder="Nhập tên sản phẩm"
            [(ngModel)]="product.name"
            name="name"
            required
          />
        </div>
      </div>
    </div>

    <!-- Dòng 1 -->
    <div class="form-row three-cols">
      <div class="form-group">
        <label class="required">Danh mục</label>
        <select
          class="form-control"
          [(ngModel)]="product.categoryId"
          name="categoryId"
        >
          <option value="">Vui lòng chọn danh mục</option>
          <option *ngFor="let cat of categories" [value]="cat.id">
            {{ cat.name }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label>Thương hiệu</label>
        <input
          type="text"
          class="form-control"
          placeholder="Nhập thương hiệu"
          [(ngModel)]="product.brand"
          name="brand"
        />
      </div>

      <div class="form-group">
        <label>Vị trí để hàng</label>
        <input
          type="text"
          class="form-control"
          placeholder="VD: Khu A, kệ số 4 tầng 2"
          [(ngModel)]="product.location"
          name="location"
        />
      </div>
    </div>

    <!-- Nội dung chính -->
    <div class="main-content">
      <div class="left-section">
        <div class="form-row">
          <div class="form-group">
            <label class="required">Giá nhập</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="product.price"
              name="price"
              required
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Giá bán buôn/bán sỉ</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="product.wholesalePrice"
              name="wholesalePrice"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Giá bán lẻ</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="product.retailPrice"
              name="retailPrice"
            />
          </div>
        </div>
      </div>

      <div class="right-section">
        <div class="form-row">
          <div class="form-group">
            <label class="required">Đơn vị</label>
            <select
              class="form-control"
              [(ngModel)]="product.unitId"
              name="unitId"
            >
              <option value="">Vui lòng chọn đơn vị</option>
              <option *ngFor="let u of units" [value]="u.id">
                {{ u.name }}
              </option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group barcode-section">
            <label>Barcode</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="product.barcode"
              name="barcode"
            />
            <button class="refresh-btn" type="button" (click)="generateBarcode()">
              Tạo barcode
            </button>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Số lượng cảnh báo hết hàng</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="product.alertQuantity"
              name="alertQuantity"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Checkbox -->
    <div class="checkbox-group">
      <div class="checkbox-item">
        <input
          type="checkbox"
          id="allow-sale"
          [(ngModel)]="product.allowSell"
          name="allowSell"
        />
        <label for="allow-sale">Cho phép bán</label>
      </div>
      <div class="checkbox-item">
        <input
          type="checkbox"
          id="fast-sale"
          [(ngModel)]="product.fastSell"
          name="fastSell"
        />
        <label for="fast-sale">Bán nhanh</label>
      </div>
    </div>
  </div>
</div>
